<div class="min-h-screen bg-gray-100 dark:bg-gray-900 transition-colors flex flex-col">
  <!-- Header -->
  <header class="flex justify-between items-center px-6 py-4 bg-white dark:bg-gray-800 shadow-sm">
    <div class="flex items-center gap-2">
      <i class="pi pi-building text-green-600 text-2xl"></i>
      <span class="text-2xl font-semibold dark:text-white">FlowPay</span>
    </div>
  </header>

  <!-- Chat Container -->
  <main class="flex-1 flex justify-center px-4 py-8">
    <div class="w-full max-w-3xl bg-white dark:bg-gray-800 rounded-xl shadow-lg flex flex-col overflow-hidden">

      <!-- Chat Header -->
      <div class="flex items-center justify-between px-6 py-4 border-b border-gray-200 dark:border-gray-700">
        <div class="flex items-center gap-4">
          <p-button icon="pi pi-arrow-left" [rounded]="true" [text]="true" (onClick)="goBack()" />
          <div class="flex items-center gap-3">
            <div class="w-10 h-10 bg-green-600 rounded-full flex items-center justify-center">
              <i class="pi pi-headphones text-white text-lg"></i>
            </div>
            <div>
              <h2 class="font-semibold dark:text-white">Atendimento FlowPay</h2>
              <div class="flex items-center gap-1 text-sm text-gray-500 dark:text-gray-400">
                <i class="pi pi-tag text-xs"></i>
                <span>{{ serviceTypeLabel() }}</span>
              </div>
            </div>
          </div>
        </div>
        <p-button
          icon="pi pi-times"
          severity="danger"
          [rounded]="true"
          [outlined]="true"
          [loading]="closing()"
          (onClick)="closeChat()"
        />
      </div>

      <!-- Messages -->
      <div class="flex-1 overflow-y-auto p-6 space-y-4 min-h-[400px] bg-gray-50 dark:bg-gray-900">
        @for (message of messages(); track $index) {
          @if (message.sender === 'user') {
            <div class="flex justify-end">
              <div class="bg-green-600 text-white rounded-lg px-4 py-3 max-w-md">
                <p class="text-sm">{{ message.text }}</p>
                <span class="text-xs opacity-70 block mt-1">{{ message.time }}</span>
              </div>
            </div>
          } @else {
            <div class="flex justify-start">
              <div class="bg-white dark:bg-gray-800 rounded-lg px-4 py-3 max-w-md border border-gray-200 dark:border-gray-700">
                <p class="text-sm dark:text-white">{{ message.text }}</p>
                <span class="text-xs text-gray-400 block mt-1">{{ message.time }}</span>
              </div>
            </div>
          }
        }
      </div>

      <!-- Input -->
      <div class="px-6 py-4 border-t border-gray-200 dark:border-gray-700">
        <form (ngSubmit)="sendMessage()" class="flex items-center gap-3">
          <input
            pInputText
            [(ngModel)]="newMessage"
            name="message"
            placeholder="Digite sua mensagem..."
            class="flex-1"
          />
          <p-button
            icon="pi pi-send"
            [rounded]="true"
            type="submit"
            [disabled]="!newMessage.trim()"
          />
        </form>
      </div>
    </div>
  </main>
</div>
